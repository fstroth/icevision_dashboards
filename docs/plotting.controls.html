---

title: plotting.controls


keywords: fastai
sidebar: home_sidebar

summary: "Supplies control elements for dashboards"
description: "Supplies control elements for dashboards"
nb_path: "nbs/plotting.controls.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/plotting.controls.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Filter" class="doc_header"><code>class</code> <code>Filter</code><a href="https://github.com/fstroth/icevision_dashboards/tree/master/icevision_dashboards/plotting/controls.py#L24" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Filter</code>(<strong><code>data</code></strong>, <strong><code>width</code></strong>=<em><code>500</code></em>, <strong><code>height</code></strong>=<em><code>500</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Abstract baseclass for a filter. A filter requires three methods to be implemented</p>
<ol>
<li><code>build_gui</code>: Defines the gui elements of the filter (slider, checkboxes etc.)</li>
<li><code>get_selection</code>: Returns a binary mask indicating which elements of the data are selected and which not</li>
<li><code>show</code>: Returns the gui of the filter</li>
<li><code>register_callback</code>: Handels the registration of callbacks. This function should contain the following line <code>callback = self.maks_callback(callback)</code> to ensure that the callback receives the current selection of the filter instead of an <code>event</code> or <code>attr</code>, <code>old</code> and <code>new</code></li>
</ol>
<p>All callbacks registered to a filter will receive the current selection of the fitler as argument. To ensure this behaviour inside the <code>register_callback</code> function the callback needs to be masked with the <code>mask_callback</code> method. If a different behaviour is need it should be sufficient to change the <code>mask_callback</code> method.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RangeFilter" class="doc_header"><code>class</code> <code>RangeFilter</code><a href="https://github.com/fstroth/icevision_dashboards/tree/master/icevision_dashboards/plotting/controls.py#L53" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RangeFilter</code>(<strong><code>data</code></strong>:<code>ndarray</code>, <strong><code>name</code></strong>:<code>str</code>, <strong><code>bins</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>steps</code></strong>:<code>int</code>=<em><code>50</code></em>, <strong><code>with_hist</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>width</code></strong>:<code>int</code>=<em><code>500</code></em>, <strong><code>height</code></strong>:<code>int</code>=<em><code>500</code></em>) :: <a href="/icevision_dashboards/plotting.controls.html#Filter"><code>Filter</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A filter that uses a range slider for selection. Best used for continuous values.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_callback</span><span class="p">(</span><span class="n">selection</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Selection should be array&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">test_range_filter</span> <span class="o">=</span> <span class="n">RangeFilter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;Values&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">test_range_filter</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span><span class="n">test_callback</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">test_range_filter</span><span class="o">.</span><span class="n">show</span><span class="p">())</span>
<span class="n">test_range_filter</span><span class="o">.</span><span class="n">update_with_mask</span><span class="p">(</span><span class="n">data</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CategoricalFilter" class="doc_header"><code>class</code> <code>CategoricalFilter</code><a href="https://github.com/fstroth/icevision_dashboards/tree/master/icevision_dashboards/plotting/controls.py#L102" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CategoricalFilter</code>(<strong><code>data</code></strong>:<code>ndarray</code>, <strong><code>name</code></strong>:<code>str</code>, <strong><code>width</code></strong>:<code>int</code>=<em><code>500</code></em>, <strong><code>height</code></strong>:<code>int</code>=<em><code>500</code></em>) :: <a href="/icevision_dashboards/plotting.controls.html#Filter"><code>Filter</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A filter for categorical data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TimeFilter" class="doc_header"><code>class</code> <code>TimeFilter</code><a href="https://github.com/fstroth/icevision_dashboards/tree/master/icevision_dashboards/plotting/controls.py#L129" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TimeFilter</code>(<strong><code>start_times</code></strong>:<code>Iterable</code>[<code>datetime</code>], <strong><code>end_times</code></strong>:<code>Iterable</code>[<code>datetime</code>], <strong><code>start_time_label</code></strong>:<code>str</code>=<em><code>'Start'</code></em>, <strong><code>end_time_label</code></strong>:<code>str</code>=<em><code>'End'</code></em>, <strong><code>width</code></strong>:<code>int</code>=<em><code>500</code></em>, <strong><code>height</code></strong>:<code>int</code>=<em><code>500</code></em>) :: <a href="/icevision_dashboards/plotting.controls.html#Filter"><code>Filter</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This filter is for time information with a start and an end date. It has two range selectors one for the selection of the start time and one for the end time. The start and end time of a data point are represented by an arc plot.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_callback</span><span class="p">(</span><span class="n">selection</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Selection should be array&quot;</span><span class="p">)</span>
<span class="n">test_start_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="n">test_end_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="n">test_time_filter</span> <span class="o">=</span> <span class="n">TimeFilter</span><span class="p">(</span><span class="n">test_start_times</span><span class="p">,</span> <span class="n">test_end_times</span><span class="p">)</span>
<span class="n">test_time_filter</span><span class="o">.</span><span class="n">end_time_slider</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_end_times</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="n">test_end_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">test_time_filter</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span>
<span class="n">test_time_filter</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span><span class="n">test_callback</span><span class="p">)</span>
<span class="n">test_time_filter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ScatterFilter" class="doc_header"><code>class</code> <code>ScatterFilter</code><a href="https://github.com/fstroth/icevision_dashboards/tree/master/icevision_dashboards/plotting/controls.py#L161" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ScatterFilter</code>(<strong><code>x</code></strong>, <strong><code>y</code></strong>, <strong><code>x_label</code></strong>:<code>str</code>=<em><code>''</code></em>, <strong><code>y_label</code></strong>:<code>str</code>=<em><code>''</code></em>, <strong><code>width</code></strong>:<code>int</code>=<em><code>500</code></em>, <strong><code>height</code></strong>:<code>int</code>=<em><code>500</code></em>) :: <a href="/icevision_dashboards/plotting.controls.html#Filter"><code>Filter</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='The callback needs to take three arguments (attr, old, new)' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scatter_select</span> <span class="o">=</span> <span class="n">ScatterFilter</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">scatter_select</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GenericMulitScatterFilter" class="doc_header"><code>class</code> <code>GenericMulitScatterFilter</code><a href="https://github.com/fstroth/icevision_dashboards/tree/master/icevision_dashboards/plotting/controls.py#L188" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GenericMulitScatterFilter</code>(<strong><code>data</code></strong>, <strong><code>columns</code></strong>:<code>Optional</code>[<code>List</code>[<code>str</code>]]=<em><code>None</code></em>, <strong><code>mode</code></strong>:<code>str</code>=<em><code>'symmetric'</code></em>, <strong><code>width</code></strong>:<code>int</code>=<em><code>500</code></em>, <strong><code>height</code></strong>:<code>int</code>=<em><code>500</code></em>) :: <a href="/icevision_dashboards/plotting.controls.html#Filter"><code>Filter</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include note.html content='And will highlight all points if the "And" selction is empty' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_multi_scatter_filter</span> <span class="o">=</span> <span class="n">GenericMulitScatterFilter</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]}))</span>
<span class="n">test_multi_scatter_filter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

